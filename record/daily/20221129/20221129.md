
Daily Record 20221129
=====================

## 流水

实验指导书；



## 知识点

##### Rust中，任何对于`static mut`变量的访问控制都是`unsafe`的。

`static` 声明一个初始化之后就不可变的全局变量；

##### 内部可变性Interior Mutability

在变量自身不可变或仅在不可变借用的情况下仍能修改绑定到变量上的值；

RefCell

##### lifetime

代码执行期间该值必须持续合法的代码区域集合；

##### & and &mut

不可变引用和可变引用不能共存；

借用同一个值的不可变引用/可变饮用的**生存期互相隔离**；

##### 并发检查

当声明一个**全局变量**，Rust编译器会默认程序员是在多线程上使用它。

如果一个变量实际上仅会在单线程上使用，那Rust会期待我们将变量分配在栈上作为局部变量而不是全局变量。

##### 应用程序上下文

包括通用寄存器和栈两部分。

与函数调用需要保存函数调用上下文一样，在执行操作系统的Trap处理过程之前，我们需要在某个地方（某内存或内核的栈）保存这些寄存器并在Trap结束后恢复这些寄存器。

##### 特权级切换

1. 硬件控制机制

   sstatus, spec, scause/stval, stvec

2. 操作系统控制

##### Trap可能会嵌套使用

这就要求对于部分CSR也要在Trap切换时候保存下来

## 总结



## 下次学习入口



##### [返回Home](../../../README.md)


