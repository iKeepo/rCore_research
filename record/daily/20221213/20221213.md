
Daily Record 20221213
=====================

## 流水

实验指导书；

## 知识点

##### 进程缘起

提供操作系统的灵活性，交互性。

让开发者能够控制程序的运行；

这个交互需求，就是`shell`的来源；

##### MULTICS进程

指一个程序/作业的执行过程；

MULTICS的目标是构建未来的计算基础设施；

##### UNIX进程

`fork`: 

`exec`: 

`wait`: 

`exit`: 

##### 任务与进程的关系与区别

都表示运行的程序，都是一个程序的执行过程；

**任务**是**进程**的初级阶段；

##### 进程 静态 vs. 动态

程序被编译成可执行文件后，是一个静态归档的文件而已；

进程，就是操作系统选取某张蓝图进行动态执行（启动生产活动）的过程；

作为一个过程，有时间性，有开始有结束；

需要对硬件资源进行动态绑定与解绑；

两个进程可以选择同一个可执行文件，却是截然不同的进程：启动时间、占据的资源、输入数据等等。

##### 可执行文件

可执行文件与其他类型文件的**根本性不同**在于，它可以被内核加载并执行；

所谓执行，指的是需要占据一些真实的硬件资源；内存，寄存器，CSR，cache，TLB等等；

可以将可执行文件视为，一张**蓝图**，一张编译器解析源码之后总结出来的，一张记载<u>如何利用各种硬件资源进行生产</u>活动的蓝图；

这个生产活动，是内核控制的；

##### 进程，线程，协程

都是操作系统的抽象概念；是管理单位；

操作系统可以以进程、线程、协程为基本的单位进行硬件资源的管理与调度；

**进程**作为CPU调度（Scheduling）和分派（Switch）的对象，各个进程之间以时间片为单元轮动使用CPU，每个进程有独立的内存，实现内存隔离；操作系统通过进程这个抽象来完成对应用程序在CPU和内存使用上的管理；

为解决进程切换开销相对较大的问题，出现了**线程**；线程是程序执行中一个单一的顺序控制流程，是进程的一部分；各个线程之间共享进程的地址空间；线程有自己独立的栈，是CPU调度和分派的基本单位；线程调度既可以在操作系统层面，也可以在用户层面（Green Thread）;

**协程**（Coroutines，纤程Fiber）也是一个单一的顺序控制流程，建立在线程之上（即一个线程可以有多个协程），协程一般由用户态管理，操作系统看不到，且多个协程共享同一线程的栈，因此在时间和空间的管理开销上，优于线程；

##### PID（Process Identifier）

系统中同一时间存在每个进程都被一个不同的进程标识符所标识；

##### Initial Process用户态初始进程

内核初始化完毕后会创建一个用户初始进程；

是内核中**唯一一个**以<u>硬编码</u>方式创建的进程；

<u>其他所有的进程</u>都是通过一个名为`fork`的系统调用来创建的；

##### `fork`

fork出来的新进程与原进程地址空间相同，通用寄存器几乎相同，除了`a0`；

原进程（Parent Process）`a0`是子进程（Child Process）的PID，子进程的`a0`是0；

##### `exit` & `waitpid`

当进程通过`exit`系统调用退出后，内核会立即收回其部分资源并将其标记为**僵尸进程**（Zombie Process），之后再由其父进程调用`waitpid`系统调用来收集该进程的返回状态并回收所有资源；

如果父进程先于子进程退出，那所有子进程会称为用户初始进程的子进程；

##### `exec`

如果只有`fork`，那所有的进程都只能和InitProcess一样执行相同的代码段，因此引入`exec`系统调用来执行不同的可执行文件；

## 总结



## 下次学习入口



##### [返回Home](../../../README.md)


